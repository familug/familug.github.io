<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="./theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="./theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="hvn" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="assembly, asm, sasm, ide, gdb, pwndbg, frontpage, " />

<meta property="og:title" content="Các công cụ để viết/chạy x64 assembly "/>
<meta property="og:url" content="./cac-cong-cu-de-vietchay-x64-assembly.html" />
<meta property="og:description" content="Bài trước viết Hello world dùng x64 assembly dù không phải quá khó, nhưng cũng dài 16 dòng, hơn cả Java, lại còn toàn magic value aex, ebx, ... nếu bảo không nhìn tài liệu, cũng khó lòng mà tự viết được từ 1 file trắng. Chuyện này nghĩa là, để …" />
<meta property="og:site_name" content="FAMILUG.org Vietnam" />
<meta property="og:article:author" content="hvn" />
<meta property="og:article:published_time" content="2023-02-26T00:00:00+07:00" />
<meta name="twitter:title" content="Các công cụ để viết/chạy x64 assembly ">
<meta name="twitter:description" content="Bài trước viết Hello world dùng x64 assembly dù không phải quá khó, nhưng cũng dài 16 dòng, hơn cả Java, lại còn toàn magic value aex, ebx, ... nếu bảo không nhìn tài liệu, cũng khó lòng mà tự viết được từ 1 file trắng. Chuyện này nghĩa là, để …">

        <title>Các công cụ để viết/chạy x64 assembly  · FAMILUG.org Vietnam
</title>



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="./"><span class=site-name>FAMILUG.org Vietnam</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       .
                                    >Home</a>
                                </li>
                                <li ><a href="./categories.html">Categories</a></li>
                                <li ><a href="./tags.html">Tags</a></li>
                                <li ><a href="./archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="./search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="./cac-cong-cu-de-vietchay-x64-assembly.html">
                Các công cụ để viết/chạy x64 assembly
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>Bài trước viết <a href="./hello-world-dung-x64-assembly.html">Hello world dùng x64 assembly</a> dù không phải quá khó, nhưng cũng dài 16 dòng, hơn cả Java, lại còn toàn magic value aex, ebx, ... nếu bảo không nhìn tài liệu, cũng khó lòng mà tự viết được từ 1 file trắng.</p>
<p>Chuyện này nghĩa là, để print cũng khó khăn, mà print khó, thì học lập trình kiểu gì? làm sao biết 1+1 ra kết quả bao nhiêu?</p>
<p>Debugger là câu trả lời!
Debugger giúp không cần print, mà vẫn biết giá trị là bao nhiêu.</p>
<p>Bài này giới thiệu 2 debugger: 1 đủ phức tạp, và 1 rất đơn giản.</p>
<h3>SASM - Simple crossplatform IDE for NASM, MASM, GAS, FASM assembly languages</h3>
<p>Một IDE đơn giản, cài trên Ubuntu 20.04 chỉ với:</p>
<div class="highlight"><pre><span></span><code>sudo apt-get install sasm
</code></pre></div>

<p>sau đó bật lên vào menu Settings &gt; settings chọn "Mode" x64 để chạy code x64.
menu "Debug", chọn "show registers" để thấy các giá trị.</p>
<p>Ví dụ thực hiện gán rax bằng 2 rồi cộng 1, thấy rax là 3</p>
<div class="highlight"><pre><span></span><code><span class="nf">mov</span><span class="w"> </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="c1">; rax=2</span>
<span class="nf">add</span><span class="w"> </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="c1">; rax+=1</span>
</code></pre></div>

<p>Bấm F5 để bắt đầu debug, bấm F11 để tới câu lệnh tiếp theo.</p>
<p><img alt="sasm" src="./images/sasm.png"></p>
<p>PS: Windows có rất nhiều tool xịn như x64dbg hay windbg.</p>
<h3>GDB - pwndbg</h3>
<p>Như đã giới thiệu trong <a href="./hoc-rust-voi-gdb.html">Học Rust với gdb</a>, gdb là debugger phổ biến bậc nhất trên môi trường Unix/Linux. <a href="./tao-giao-dien-gdb-nhu-pedagefpwndbg.html">Cài thêm extension vào để có màu mè</a> , ở đây chọn <a href="https://github.com/pwndbg/pwndbg">pwndbg</a>:</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/pwndbg/pwndbg
cd pwndbg
./setup.sh
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nf">global</span><span class="w"> </span><span class="no">_start</span><span class="w"></span>

<span class="nf">section</span><span class="w"> </span><span class="no">.text</span><span class="w"></span>
<span class="nl">_start:</span><span class="w"></span>
<span class="w">    </span><span class="nf">mov</span><span class="w"> </span><span class="no">rbp</span><span class="p">,</span><span class="w"> </span><span class="no">rsp</span><span class="c1">; for correct debugging</span>
<span class="w">    </span><span class="nf">mov</span><span class="w"> </span><span class="no">ebp</span><span class="p">,</span><span class="w"> </span><span class="no">esp</span><span class="c1">; for correct debugging</span>
<span class="w">    </span><span class="c1">;write your code here</span>
<span class="w">    </span><span class="nf">mov</span><span class="w"> </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">    </span><span class="nf">add</span><span class="w"> </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>

<span class="w">    </span><span class="nf">xor</span><span class="w"> </span><span class="no">rdx</span><span class="p">,</span><span class="w"> </span><span class="no">rdx</span><span class="w"></span>
<span class="w">    </span><span class="nf">mov</span><span class="w"> </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="w"></span>
<span class="w">    </span><span class="nf">mov</span><span class="w"> </span><span class="no">r8</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="w">    </span><span class="nf">div</span><span class="w"> </span><span class="no">r8</span><span class="w"></span>

<span class="w">    </span><span class="nf">mov</span><span class="w"> </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="w">    </span><span class="nf">add</span><span class="w"> </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>

<span class="w">    </span><span class="nf">xor</span><span class="w"> </span><span class="no">rdx</span><span class="p">,</span><span class="w"> </span><span class="no">rdx</span><span class="w"></span>
<span class="w">    </span><span class="nf">mul</span><span class="w"> </span><span class="no">rcx</span><span class="w"></span>
<span class="w">    </span><span class="nf">sub</span><span class="w"> </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>

<span class="w">    </span><span class="nf">xor</span><span class="w"> </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="no">eax</span><span class="w"></span>
<span class="w">    </span><span class="nf">ret</span><span class="w"></span>
</code></pre></div>

<p>build file asm rồi chạy:</p>
<div class="highlight"><pre><span></span><code><span class="nf">$</span><span class="w"> </span><span class="no">sudo</span><span class="w"> </span><span class="no">apt</span><span class="w"> </span><span class="no">install</span><span class="w"> </span><span class="p">-</span><span class="no">y</span><span class="w"> </span><span class="no">nasm</span><span class="w"></span>
<span class="nf">$</span><span class="w"> </span><span class="no">nasm</span><span class="w"> </span><span class="p">-</span><span class="no">felf64</span><span class="w"> </span><span class="no">test.asm</span><span class="w"></span>
<span class="nf">$</span><span class="w"> </span><span class="no">ld</span><span class="w"> </span><span class="no">test.o</span><span class="w"></span>
<span class="nf">$</span><span class="w"> </span><span class="no">gdb</span><span class="w"> </span><span class="p">.</span><span class="err">/</span><span class="no">a.out</span><span class="w"></span>
</code></pre></div>

<p><img alt="pwndbg" src="./images/pwndbg.png"></p>
<h3>Kết luận</h3>
<p>Không print được thì dùng debugger. Dùng debugger thì không còn phải print nữa.</p>
<p>Happy debugging!</p>
<p>Hết.</p>
<p>HVN at <a href="http://pymi.vn">http://pymi.vn</a> and <a href="https://www.familug.org">https://www.familug.org</a>.</p>
<p><a href="https://www.familug.org/p/ung-ho.html">Ủng hộ tác giả 🍺</a></p>


             
 
            
            
            







            <hr/>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2023-02-26T00:00:00+07:00">Sun 26 February 2023</time>
            <h4>Category</h4>
            <a class="category-link" href="./categories.html#frontpage-ref">frontpage</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="./tags.html#asm-ref">asm
                    <span class="superscript">3</span>
</a></li>
                <li><a href="./tags.html#assembly-ref">assembly
                    <span class="superscript">3</span>
</a></li>
                <li><a href="./tags.html#gdb-ref">gdb
                    <span class="superscript">4</span>
</a></li>
                <li><a href="./tags.html#ide-ref">ide
                    <span class="superscript">1</span>
</a></li>
                <li><a href="./tags.html#pwndbg-ref">pwndbg
                    <span class="superscript">2</span>
</a></li>
                <li><a href="./tags.html#sasm-ref">sasm
                    <span class="superscript">1</span>
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="./theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>