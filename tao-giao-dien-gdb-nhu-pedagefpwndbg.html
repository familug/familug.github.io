<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="./theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="./theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="hvn" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="gdb, gef, pwndbg, peda, debugger, python, frontpage, " />

<meta property="og:title" content="Tạo giao diện gdb như peda/gef/pwndbg "/>
<meta property="og:url" content="./tao-giao-dien-gdb-nhu-pedagefpwndbg.html" />
<meta property="og:description" content="GDB là một debugger lâu đời có rất nhiều tính năng. Nó giống vim /emacs nhiều điểm: nhiều tính năng nhưng mặc định thì không bật gì, khó dùng cài thêm các tính năng vào sẽ ngon lành việc cấu hình cũng cần phải học, nên có nhiều bản &#34;distro …" />
<meta property="og:site_name" content="FAMILUG.org Vietnam" />
<meta property="og:article:author" content="hvn" />
<meta property="og:article:published_time" content="2023-01-20T00:00:00+07:00" />
<meta name="twitter:title" content="Tạo giao diện gdb như peda/gef/pwndbg ">
<meta name="twitter:description" content="GDB là một debugger lâu đời có rất nhiều tính năng. Nó giống vim /emacs nhiều điểm: nhiều tính năng nhưng mặc định thì không bật gì, khó dùng cài thêm các tính năng vào sẽ ngon lành việc cấu hình cũng cần phải học, nên có nhiều bản &#34;distro …">

        <title>Tạo giao diện gdb như peda/gef/pwndbg  · FAMILUG.org Vietnam
</title>



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="./"><span class=site-name>FAMILUG.org Vietnam</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       .
                                    >Home</a>
                                </li>
                                <li ><a href="./categories.html">Categories</a></li>
                                <li ><a href="./tags.html">Tags</a></li>
                                <li ><a href="./archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="./search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="./tao-giao-dien-gdb-nhu-pedagefpwndbg.html">
                Tạo giao diện gdb như peda/gef/pwndbg
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>GDB là một debugger lâu đời có rất nhiều tính năng. Nó giống <code>vim</code> /<code>emacs</code> nhiều điểm:</p>
<ul>
<li>nhiều tính năng nhưng mặc định thì không bật gì, khó dùng
  <img alt="gdb_tui" src="./images/gdb_tui.png"></li>
<li>cài thêm các tính năng vào sẽ ngon lành</li>
<li>việc cấu hình cũng cần phải học, nên có nhiều bản "distro" dùng sẵn.</li>
<li>sau hàng chục năm config chán chê, người dùng hardcore lại quay về 1 file config đơn giản.</li>
</ul>
<p>GDB các bản mở rộng dễ dùng/tiện dụng hơn có:</p>
<ul>
<li><a href="https://github.com/pwndbg/pwndbg">https://github.com/pwndbg/pwndbg</a></li>
<li><a href="https://github.com/longld/peda">https://github.com/longld/peda</a></li>
<li><a href="https://github.com/hugsy/gef">https://github.com/hugsy/gef</a></li>
<li><a href="https://github.com/snare/voltron">https://github.com/snare/voltron</a></li>
</ul>
<p>Như vim có</p>
<ul>
<li><a href="https://spacevim.org/">spacevim</a></li>
<li><a href="http://vim.spf13.com/">spf13-vim</a></li>
<li>...</li>
</ul>
<p>Tương tự với emacs:</p>
<ul>
<li><a href="https://www.spacemacs.org/">spacemacs</a></li>
<li><a href="https://github.com/doomemacs/doomemacs">doomemacs</a></li>
</ul>
<p>PS: tham khảo 2 phần trước:</p>
<ul>
<li>p1: <a href="https://n.pymi.vn/hgdb.html">https://n.pymi.vn/hgdb.html</a></li>
<li>p2: <a href="https://n.pymi.vn/hgdb-arch.html">https://n.pymi.vn/hgdb-arch.html</a></li>
</ul>
<p>PPS: nên đọc trên máy tính.</p>
<h3>Tạo giao diện giống pwndbg/gef/peda</h3>
<p><img alt="pwndbg" src="https://github.com/pwndbg/pwndbg/raw/dev/caps/context.png"></p>
<p>3 bản mở rộng này nhìn chung đều có giao diện giống nhau. Màn hình sẽ hiện "context" với 3 phần:</p>
<ul>
<li>các register</li>
<li>disassembly code</li>
<li>stack</li>
</ul>
<h4>gdb lấy thông tin các register</h4>
<p>Lệnh gdb <code>info registers</code> sẽ hiện thông tin của tất cả các register.</p>
<div class="highlight"><pre><span></span><code>$ gdb ./a.out -q
Reading symbols from ./a.out...
<span class="o">(</span>No debugging symbols found <span class="k">in</span> ./a.out<span class="o">)</span>
<span class="o">(</span>gdb<span class="o">)</span> start
Temporary breakpoint <span class="m">1</span> at 0x1149
Starting program: /home/hvn/me/news/a.out

Temporary breakpoint <span class="m">1</span>, 0x0000555555555149 <span class="k">in</span> main <span class="o">()</span>
<span class="o">(</span>gdb<span class="o">)</span> info registers
rax            0x555555555149      <span class="m">93824992235849</span>
rbx            0x5555555551a0      <span class="m">93824992235936</span>
rcx            0x5555555551a0      <span class="m">93824992235936</span>
rdx            0x7fffffffe548      <span class="m">140737488348488</span>
rsi            0x7fffffffe538      <span class="m">140737488348472</span>
rdi            0x1                 <span class="m">1</span>
rbp            0x0                 0x0
rsp            0x7fffffffe448      0x7fffffffe448
r8             0x0                 <span class="m">0</span>
r9             0x7ffff7fe0d60      <span class="m">140737354009952</span>
r10            0x7                 <span class="m">7</span>
r11            0x2                 <span class="m">2</span>
r12            0x555555555060      <span class="m">93824992235616</span>
r13            0x7fffffffe530      <span class="m">140737488348464</span>
r14            0x0                 <span class="m">0</span>
r15            0x0                 <span class="m">0</span>
rip            0x555555555149      0x555555555149 &lt;main&gt;
eflags         0x246               <span class="o">[</span> PF ZF IF <span class="o">]</span>
cs             0x33                <span class="m">51</span>
ss             0x2b                <span class="m">43</span>
ds             0x0                 <span class="m">0</span>
es             0x0                 <span class="m">0</span>
fs             0x0                 <span class="m">0</span>
gs             0x0                 <span class="m">0</span>
<span class="o">(</span>gdb<span class="o">)</span>
</code></pre></div>

<p>Để lấy thông tin của 1 register cụ thể, ví dụ rsp, gõ <code>info register rsp</code>.</p>
<p>So với pwndbg</p>
<div class="highlight"><pre><span></span><code> RAX  0x555555555149 (main) ◂— endbr64
 RBX  0x5555555551a0 (__libc_csu_init) ◂— endbr64
 RCX  0x5555555551a0 (__libc_csu_init) ◂— endbr64
 RDX  0x7fffffffe488 —▸ 0x7fffffffe80a ◂— &#39;SSH_AUTH_SOCK=/run/user/1000/keyring/ssh&#39;
 RDI  0x1
 RSI  0x7fffffffe478 —▸ 0x7fffffffe7f2 ◂— &#39;/home/hvn/me/news/a.out&#39;
 R8   0x0
 R9   0x7ffff7fe0d60 (_dl_fini) ◂— endbr64
 R10  0x7
 R11  0x2
 R12  0x555555555060 (_start) ◂— endbr64
 R13  0x7fffffffe470 ◂— 0x1
 R14  0x0
 R15  0x0
 RBP  0x0
 RSP  0x7fffffffe388 —▸ 0x7ffff7dd8083 (__libc_start_main+243) ◂— mov    edi, eax
 RIP  0x555555555149 (main) ◂— endbr64
</code></pre></div>

<p>Thứ tự có thay đổi 1 chút và chỉ hiển thị tới RIP.</p>
<p>so với gef:</p>
<div class="highlight"><pre><span></span><code>$rax   : 0x0000555555555149  →  &lt;main+0&gt; endbr64
$rbx   : 0x00005555555551a0  →  &lt;__libc_csu_init+0&gt; endbr64
$rcx   : 0x00005555555551a0  →  &lt;__libc_csu_init+0&gt; endbr64
$rdx   : 0x00007fffffffe488  →  0x00007fffffffe80a  →  &quot;SSH_AUTH_SOCK=/run/user/1000/keyring/ssh&quot;
$rsp   : 0x00007fffffffe388  →  0x00007ffff7dd8083  →  &lt;__libc_start_main+243&gt; mov edi, eax
$rbp   : 0x0
$rsi   : 0x00007fffffffe478  →  0x00007fffffffe7f2  →  &quot;/home/hvn/me/news/a.out&quot;
$rdi   : 0x1
$rip   : 0x0000555555555149  →  &lt;main+0&gt; endbr64
$r8    : 0x0
$r9    : 0x00007ffff7fe0d60  →  &lt;_dl_fini+0&gt; endbr64
$r10   : 0x7
$r11   : 0x2
$r12   : 0x0000555555555060  →  &lt;_start+0&gt; endbr64
$r13   : 0x00007fffffffe470  →  0x0000000000000001
$r14   : 0x0
$r15   : 0x0
$eflags: [ZERO carry PARITY adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x33 $ss: 0x2b $ds: 0x00 $es: 0x00 $fs: 0x00 $gs: 0x00
</code></pre></div>

<p>Hiện đủ các registers.</p>
<p>Cả 2 phiên bản này đều có giá trị thứ 2 là tên function nếu có thể tìm được.</p>
<p>Có thể sử dụng lệnh <code>x</code> để thu được kết quả tương tự:</p>
<div class="highlight"><pre><span></span><code>(gdb) x $rax
0x555555555149 &lt;main&gt;:  0xfa1e0ff3
(gdb) x $rbx
0x5555555551a0 &lt;__libc_csu_init&gt;:   0xfa1e0ff3
</code></pre></div>

<p>dùng <code>x/i</code> để "examine instruction" tại đó:</p>
<div class="highlight"><pre><span></span><code>(gdb) x/i $rax
=&gt; 0x555555555149 &lt;main&gt;:   endbr64
</code></pre></div>

<p>Viết câu lệnh context chạy <code>info registers</code> rồi lặp qua các register chạy <code>x/i</code> sẽ thu được kết quả như pwndbg/gef.</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">invoke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">from_tty</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="s2">&quot;info registers&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">register</span><span class="p">,</span> <span class="n">_address</span><span class="p">,</span> <span class="o">*</span><span class="n">contents</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x/i $</span><span class="si">{</span><span class="n">register</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot; =&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">in</span> <span class="n">r</span> <span class="ow">and</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">in</span> <span class="n">r</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:&lt;15}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">register</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>(gdb) context
rax            0x555555555149 &lt;main&gt;:   endbr64
rbx            0x5555555551a0 &lt;__libc_csu_init&gt;:    endbr64
rcx            0x5555555551a0 &lt;__libc_csu_init&gt;:    endbr64
rdx            0x7fffffffe548      140737488348488
rsi            0x7fffffffe538      140737488348472
rdi            0x1                 1
rbp            0x0                 0x0
rsp            0x7fffffffe448      0x7fffffffe448
r8             0x0                 0
r9             0x7ffff7fe0d60 &lt;_dl_fini&gt;:   endbr64
r10            0x7                 7
r11            0x2                 2
r12            0x555555555060 &lt;_start&gt;: endbr64
r13            0x7fffffffe530      140737488348464
r14            0x0                 0
r15            0x0                 0
rip            0x555555555149 &lt;main&gt;:   endbr64
</code></pre></div>

<h4>gdb disassemble code</h4>
<p>Hiển thị các instruction tương ứng trước và sau vị trí "hiện tại". Trên kiến trúc x86, đó là register <code>rip</code> (register instruction pointer), trên kiến trúc khác có thể là register khác, vậy nên GDB dùng tên chung <code>pc</code> (program counter) để thay tương ứng cho từng kiến trúc.</p>
<p>Phần này có tên là DISASM hoặc CODE</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="err">0</span><span class="nf">x555555555149</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">&gt;</span><span class="w">       </span><span class="no">endbr64</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555514d</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">4</span><span class="err">&gt;</span><span class="w">     </span><span class="no">push</span><span class="w">   </span><span class="no">rbp</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555514e</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">5</span><span class="err">&gt;</span><span class="w">     </span><span class="no">mov</span><span class="w">    </span><span class="no">rbp</span><span class="p">,</span><span class="w"> </span><span class="no">rsp</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555151</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">8</span><span class="err">&gt;</span><span class="w">     </span><span class="no">sub</span><span class="w">    </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">0x20</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555155</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">12</span><span class="err">&gt;</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rbp</span><span class="w"> </span><span class="p">-</span><span class="w"> </span><span class="mi">0x14</span><span class="p">],</span><span class="w"> </span><span class="no">edi</span><span class="w"></span>
<span class="w"> </span><span class="err">►</span><span class="w"> </span><span class="err">0</span><span class="nf">x555555555158</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">15</span><span class="err">&gt;</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">qword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rbp</span><span class="w"> </span><span class="p">-</span><span class="w"> </span><span class="mi">0x20</span><span class="p">],</span><span class="w"> </span><span class="no">rsi</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555515c</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">19</span><span class="err">&gt;</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rbp</span><span class="w"> </span><span class="p">-</span><span class="w"> </span><span class="mi">0xc</span><span class="p">],</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555163</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">26</span><span class="err">&gt;</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rbp</span><span class="w"> </span><span class="p">-</span><span class="w"> </span><span class="mi">8</span><span class="p">],</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555516a</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">33</span><span class="err">&gt;</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">edx</span><span class="p">,</span><span class="w"> </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rbp</span><span class="w"> </span><span class="p">-</span><span class="w"> </span><span class="mi">0xc</span><span class="p">]</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555516d</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">36</span><span class="err">&gt;</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rbp</span><span class="w"> </span><span class="p">-</span><span class="w"> </span><span class="mi">8</span><span class="p">]</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555170</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">39</span><span class="err">&gt;</span><span class="w">    </span><span class="no">add</span><span class="w">    </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="no">edx</span><span class="w"></span>
</code></pre></div>

<p>Ta có thể lấy vị trí của <code>$pc</code> rồi in ra vài instruction trước và sau <code>$pc</code>, sử dụng lệnh <code>x/10i $pc</code>.</p>
<div class="highlight"><pre><span></span><code><span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">set</span><span class="w"> </span><span class="no">disassembly-flavor</span><span class="w"> </span><span class="no">intel</span><span class="w"></span>
<span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">start</span><span class="w"></span>
<span class="nf">Temporary</span><span class="w"> </span><span class="no">breakpoint</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="no">at</span><span class="w"> </span><span class="mi">0x1161</span><span class="w"></span>
<span class="nf">Starting</span><span class="w"> </span><span class="no">program</span><span class="p">:</span><span class="w"> </span><span class="err">/</span><span class="no">home</span><span class="err">/</span><span class="no">hvn</span><span class="err">/</span><span class="no">me</span><span class="err">/</span><span class="no">news</span><span class="err">/</span><span class="no">main</span><span class="w"></span>

<span class="nf">Temporary</span><span class="w"> </span><span class="no">breakpoint</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0x0000555555555161</span><span class="w"> </span><span class="no">in</span><span class="w"> </span><span class="no">main</span><span class="w"> </span><span class="p">()</span><span class="w"></span>
<span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">x</span><span class="err">/</span><span class="mi">10</span><span class="no">i</span><span class="w"> </span><span class="no">$pc</span><span class="w"></span>
<span class="err">=&gt;</span><span class="w"> </span><span class="err">0</span><span class="nf">x555555555161</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">&gt;</span><span class="p">:</span><span class="w">   </span><span class="no">endbr64</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555165</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">4</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="no">push</span><span class="w">   </span><span class="no">rbp</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555166</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">5</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="no">mov</span><span class="w">    </span><span class="no">rbp</span><span class="p">,</span><span class="no">rsp</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555169</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">8</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="no">sub</span><span class="w">    </span><span class="no">rsp</span><span class="p">,</span><span class="mi">0x20</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555516d</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">12</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0x14</span><span class="p">],</span><span class="no">edi</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555170</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">15</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0x20</span><span class="p">],</span><span class="no">rsi</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555174</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">19</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0xc</span><span class="p">],</span><span class="mi">0x5</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555517b</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">26</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0x8</span><span class="p">],</span><span class="mi">0x7</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555182</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">33</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">edx</span><span class="p">,</span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0x8</span><span class="p">]</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555185</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">36</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0xc</span><span class="p">]</span><span class="w"></span>
</code></pre></div>

<p>Khi binary không chứa <code>debug_info</code> (compile -g) như khi dev, không có sourcecode để gdb xem <code>n</code>ext - dòng code tiếp theo ứng với địa chỉ nào, ta phải tự đặt breakpoint tại địa chỉ rồi <code>c</code>ontinue chạy tiếp:</p>
<div class="highlight"><pre><span></span><code><span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">b</span><span class="w"> </span><span class="p">*</span><span class="mi">0x555555555182</span><span class="w"></span>
<span class="nf">Breakpoint</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="no">at</span><span class="w"> </span><span class="mi">0x555555555182</span><span class="w"></span>
<span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">c</span><span class="w"></span>
<span class="nf">Continuing.</span><span class="w"></span>

<span class="nf">Breakpoint</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0x0000555555555182</span><span class="w"> </span><span class="no">in</span><span class="w"> </span><span class="no">main</span><span class="w"> </span><span class="p">()</span><span class="w"></span>
<span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">x</span><span class="err">/</span><span class="mi">10</span><span class="no">i</span><span class="w"> </span><span class="no">$pc</span><span class="w"></span>
<span class="err">=&gt;</span><span class="w"> </span><span class="err">0</span><span class="nf">x555555555182</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">33</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">edx</span><span class="p">,</span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0x8</span><span class="p">]</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555185</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">36</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0xc</span><span class="p">]</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555188</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">39</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">esi</span><span class="p">,</span><span class="no">edx</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555518a</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">41</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">edi</span><span class="p">,</span><span class="no">eax</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555518c</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">43</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">call</span><span class="w">   </span><span class="mh">0x555555555149</span> <span class="p">&lt;</span><span class="no">sum</span><span class="p">&gt;</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555191</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">48</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0x4</span><span class="p">],</span><span class="no">eax</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555194</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">51</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0x4</span><span class="p">]</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555197</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">54</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">esi</span><span class="p">,</span><span class="no">eax</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555199</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">56</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">lea</span><span class="w">    </span><span class="no">rdi</span><span class="p">,[</span><span class="no">rip</span><span class="err">+</span><span class="mi">0xe64</span><span class="p">]</span><span class="w">        </span><span class="c1"># 0x555555556004</span>
<span class="w">   </span><span class="err">0</span><span class="nf">x5555555551a0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">63</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">eax</span><span class="p">,</span><span class="mi">0x0</span><span class="w"></span>
<span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

<p>Để in ra trước <code>$pc</code>, cần thực hiện 1 chút tính toán để tìm kiếm địa chỉ hợp lệ rồi in ra từ địa chỉ đó thay vì <code>$pc</code>, ví dụ ở đây sau khi tính được ra địa chỉ là <code>$pc-21</code>, ta có:</p>
<div class="highlight"><pre><span></span><code><span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">x</span><span class="err">/</span><span class="mi">10</span><span class="no">i</span><span class="w"> </span><span class="p">(</span><span class="no">$pc-21</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555516d</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">12</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0x14</span><span class="p">],</span><span class="no">edi</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555170</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">15</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0x20</span><span class="p">],</span><span class="no">rsi</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555174</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">19</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0xc</span><span class="p">],</span><span class="mi">0x5</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555517b</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">26</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0x8</span><span class="p">],</span><span class="mi">0x7</span><span class="w"></span>
<span class="err">=&gt;</span><span class="w"> </span><span class="err">0</span><span class="nf">x555555555182</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">33</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">edx</span><span class="p">,</span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0x8</span><span class="p">]</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555185</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">36</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0xc</span><span class="p">]</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555188</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">39</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">esi</span><span class="p">,</span><span class="no">edx</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555518a</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">41</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">edi</span><span class="p">,</span><span class="no">eax</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555518c</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">43</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">call</span><span class="w">   </span><span class="mh">0x555555555149</span> <span class="p">&lt;</span><span class="no">sum</span><span class="p">&gt;</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555191</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">48</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">DWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-0x4</span><span class="p">],</span><span class="no">eax</span><span class="w"></span>
</code></pre></div>

<p>Ở đây, để đơn giản sẽ tạm bỏ qua tính toán và chỉ in từ <code>$pc</code> trở đi:</p>
<p>Code python để in ra phần DISASM:</p>
<div class="highlight"><pre><span></span><code>        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="s2">&quot;x/10i $pc&quot;</span><span class="p">))</span>
</code></pre></div>

<h4>gdb hiển thị stack</h4>
<p>Hiển thị stack là hiển thị giá trị của  các địa chỉ từ <code>$rsp</code> (register stack pointer)
tới <code>$rbp</code> (register base pointer):</p>
<p>pwndbg:</p>
<div class="highlight"><pre><span></span><code><span class="err">00:0000│</span><span class="w"> </span><span class="nf">rsp</span><span class="w"> </span><span class="mi">0x7fffffffe358</span><span class="w"> </span><span class="err">—▸</span><span class="w"> </span><span class="mi">0x555555555191</span><span class="w"> </span><span class="p">(</span><span class="no">main</span><span class="err">+</span><span class="mi">48</span><span class="p">)</span><span class="w"> </span><span class="err">◂—</span><span class="w"> </span><span class="no">mov</span><span class="w">    </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rbp</span><span class="w"> </span><span class="p">-</span><span class="w"> </span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="no">eax</span><span class="w"></span>
<span class="err">01:0008│</span><span class="w">     </span><span class="err">0</span><span class="nf">x7fffffffe360</span><span class="w"> </span><span class="err">—▸</span><span class="w"> </span><span class="mi">0x7fffffffe478</span><span class="w"> </span><span class="err">—▸</span><span class="w"> </span><span class="mi">0x7fffffffe7f5</span><span class="w"> </span><span class="err">◂—</span><span class="w"> </span><span class="err">&#39;/</span><span class="no">home</span><span class="err">/</span><span class="no">hvn</span><span class="err">/</span><span class="no">me</span><span class="err">/</span><span class="no">news</span><span class="err">/</span><span class="no">main</span><span class="err">&#39;</span><span class="w"></span>
<span class="err">02:0010│</span><span class="w">     </span><span class="err">0</span><span class="nf">x7fffffffe368</span><span class="w"> </span><span class="err">◂—</span><span class="w"> </span><span class="mi">0x155555060</span><span class="w"></span>
<span class="err">03:0018│</span><span class="w">     </span><span class="err">0</span><span class="nf">x7fffffffe370</span><span class="w"> </span><span class="err">◂—</span><span class="w"> </span><span class="mi">0x5ffffe470</span><span class="w"></span>
<span class="err">04:0020│</span><span class="w">     </span><span class="err">0</span><span class="nf">x7fffffffe378</span><span class="w"> </span><span class="err">◂—</span><span class="w"> </span><span class="mi">0x7</span><span class="w"></span>
<span class="err">05:0028│</span><span class="w"> </span><span class="nf">rbp</span><span class="w"> </span><span class="mi">0x7fffffffe380</span><span class="w"> </span><span class="err">◂—</span><span class="w"> </span><span class="mi">0x0</span><span class="w"></span>
<span class="err">06:0030│</span><span class="w">     </span><span class="err">0</span><span class="nf">x7fffffffe388</span><span class="w"> </span><span class="err">—▸</span><span class="w"> </span><span class="mi">0x7ffff7dd8083</span><span class="w"> </span><span class="p">(</span><span class="no">__libc_start_main</span><span class="err">+</span><span class="mi">243</span><span class="p">)</span><span class="w"> </span><span class="err">◂—</span><span class="w"> </span><span class="no">mov</span><span class="w">    </span><span class="no">edi</span><span class="p">,</span><span class="w"> </span><span class="no">eax</span><span class="w"></span>
<span class="err">07:0038│</span><span class="w">     </span><span class="err">0</span><span class="nf">x7fffffffe390</span><span class="w"> </span><span class="err">—▸</span><span class="w"> </span><span class="mi">0x7ffff7ffc620</span><span class="w"> </span><span class="p">(</span><span class="no">_rtld_global_ro</span><span class="p">)</span><span class="w"> </span><span class="err">◂—</span><span class="w"> </span><span class="mi">0x50f4a00000000</span><span class="w"></span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>(gdb) print ($rbp-$rsp)
$4 = 40
</code></pre></div>

<p>Cách nhau 40 bytes, chia cho 4 được 10 "word" (1 word = 4 bytes)</p>
<div class="highlight"><pre><span></span><code>(gdb) x/10w $rsp
0x7fffffffe358: 0x55555191  0x00005555  0xffffe478  0x00007fff
0x7fffffffe368: 0x55555060  0x00000001  0xffffe470  0x00000005
0x7fffffffe378: 0x00000007  0x00000000
</code></pre></div>

<p>Code Python:</p>
<div class="highlight"><pre><span></span><code>        <span class="n">word_to_print</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="s2">&quot;print ($rbp -$rsp)/4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x/</span><span class="si">{</span><span class="n">word_to_print</span><span class="si">}</span><span class="s2">w $rsp&quot;</span><span class="p">))</span>
</code></pre></div>

<h3>Hiện context sau mỗi câu lệnh gdb</h3>
<p>GDB có "hook" để tự chạy mỗi câu lệnh trước/sau một hành động.
<code>hook-stop</code> sẽ chạy trước mỗi câu lẹnh.</p>
<p>Thêm code Python:</p>
<div class="highlight"><pre><span></span><code><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;define hook-stop</span>
<span class="s2">context</span>
<span class="s2">end&quot;&quot;&quot;</span><span class="p">)</span>
</code></pre></div>

<h3>Kết quả</h3>
<div class="highlight"><pre><span></span><code><span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">b</span><span class="w"> </span><span class="p">*</span><span class="mi">0x555555555182</span><span class="w"></span>
<span class="nf">Breakpoint</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="no">at</span><span class="w"> </span><span class="mi">0x555555555182</span><span class="w"></span>
<span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">c</span><span class="w"></span>
<span class="nf">Continuing.</span><span class="w"></span>
<span class="nf">rax</span><span class="w">            </span><span class="mh">0x555555555161</span> <span class="p">&lt;</span><span class="no">main</span><span class="p">&gt;:</span><span class="w">   </span><span class="no">endbr64</span><span class="w"></span>
<span class="nf">rbx</span><span class="w">            </span><span class="mh">0x5555555551c0</span> <span class="p">&lt;</span><span class="no">__libc_csu_init</span><span class="p">&gt;:</span><span class="w">    </span><span class="no">endbr64</span><span class="w"></span>
<span class="nf">rcx</span><span class="w">            </span><span class="mh">0x5555555551c0</span> <span class="p">&lt;</span><span class="no">__libc_csu_init</span><span class="p">&gt;:</span><span class="w">    </span><span class="no">endbr64</span><span class="w"></span>
<span class="nf">rdx</span><span class="w">            </span><span class="mi">0x7fffffffe548</span><span class="w">      </span><span class="mi">140737488348488</span><span class="w"></span>
<span class="nf">rsi</span><span class="w">            </span><span class="mi">0x7fffffffe538</span><span class="w">      </span><span class="mi">140737488348472</span><span class="w"></span>
<span class="nf">rdi</span><span class="w">            </span><span class="mi">0x1</span><span class="w">                 </span><span class="mi">1</span><span class="w"></span>
<span class="nf">rbp</span><span class="w">            </span><span class="mi">0x7fffffffe440</span><span class="w">      </span><span class="mi">0x7fffffffe440</span><span class="w"></span>
<span class="nf">rsp</span><span class="w">            </span><span class="mi">0x7fffffffe420</span><span class="w">      </span><span class="mi">0x7fffffffe420</span><span class="w"></span>
<span class="nf">r8</span><span class="w">             </span><span class="mi">0x0</span><span class="w">                 </span><span class="mi">0</span><span class="w"></span>
<span class="nf">r9</span><span class="w">             </span><span class="mh">0x7ffff7fe0d60</span> <span class="p">&lt;</span><span class="no">_dl_fini</span><span class="p">&gt;:</span><span class="w">   </span><span class="no">endbr64</span><span class="w"></span>
<span class="nf">r10</span><span class="w">            </span><span class="mi">0x7</span><span class="w">                 </span><span class="mi">7</span><span class="w"></span>
<span class="nf">r11</span><span class="w">            </span><span class="mi">0x2</span><span class="w">                 </span><span class="mi">2</span><span class="w"></span>
<span class="nf">r12</span><span class="w">            </span><span class="mh">0x555555555060</span> <span class="p">&lt;</span><span class="no">_start</span><span class="p">&gt;:</span><span class="w"> </span><span class="no">endbr64</span><span class="w"></span>
<span class="nf">r13</span><span class="w">            </span><span class="mi">0x7fffffffe530</span><span class="w">      </span><span class="mi">140737488348464</span><span class="w"></span>
<span class="nf">r14</span><span class="w">            </span><span class="mi">0x0</span><span class="w">                 </span><span class="mi">0</span><span class="w"></span>
<span class="nf">r15</span><span class="w">            </span><span class="mi">0x0</span><span class="w">                 </span><span class="mi">0</span><span class="w"></span>
<span class="nf">rip</span><span class="w">            </span><span class="mh">0x555555555182</span> <span class="p">&lt;</span><span class="no">main</span><span class="p">+</span><span class="mi">33</span><span class="p">&gt;:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%edx</span><span class="w"></span>
<span class="err">====================</span><span class="nf">DISASM</span><span class="err">====================</span><span class="w"></span>
<span class="err">=&gt;</span><span class="w"> </span><span class="err">0</span><span class="nf">x555555555182</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">33</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%edx</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555185</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">36</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555188</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">39</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edx</span><span class="p">,</span><span class="nv">%esi</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555518a</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">41</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%edi</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x55555555518c</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">43</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">callq</span><span class="w">  </span><span class="mh">0x555555555149</span> <span class="p">&lt;</span><span class="no">sum</span><span class="p">&gt;</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555191</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">48</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555194</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">51</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555197</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">54</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%esi</span><span class="w"></span>
<span class="w">   </span><span class="err">0</span><span class="nf">x555555555199</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">56</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">lea</span><span class="w">    </span><span class="mi">0xe64</span><span class="p">(</span><span class="nv">%rip</span><span class="p">),</span><span class="nv">%rdi</span><span class="w">        </span><span class="c1"># 0x555555556004</span>
<span class="w">   </span><span class="err">0</span><span class="nf">x5555555551a0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">main</span><span class="err">+</span><span class="mi">63</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w"></span>

<span class="err">====================</span><span class="nf">STACK</span><span class="err">====================</span><span class="w"></span>
<span class="err">0</span><span class="nl">x7fffffffe420:</span><span class="w"> </span><span class="err">0</span><span class="nf">xffffe538</span><span class="w">  </span><span class="mi">0x00007fff</span><span class="w">  </span><span class="mi">0x55555060</span><span class="w">  </span><span class="mi">0x00000001</span><span class="w"></span>
<span class="err">0</span><span class="nl">x7fffffffe430:</span><span class="w"> </span><span class="err">0</span><span class="nf">xffffe530</span><span class="w">  </span><span class="mi">0x00000005</span><span class="w">  </span><span class="mi">0x00000007</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w"></span>
</code></pre></div>

<p>Tô màu mè, format đẹp lại là có một phiên bản gdb do chính tay bạn làm ra.</p>
<p>Code at <a href="https://github.com/hvnsweeting/hgdb/blob/v0.1/hgdb.py">https://github.com/hvnsweeting/hgdb/blob/v0.1/hgdb.py</a></p>
<h3>Kết luận</h3>
<p>Python được dùng phổ biến để mở rộng tính năng cho các phần mềm khác (<a href="https://docs.blender.org/api/current/info_overview.html">blender</a>, <a href="https://manual.calibre-ebook.com/creating_plugins.html">calibre</a>, ...)</p>
<p>Với sự có mặt của Python (và Guile), gdb đã cho phép mình tự biến hóa thành những sản phẩm đầy tiện lợi sang xịn mịn nhờ cồng đồng.</p>
<p>Và bạn cũng có thể tự làm agdb bgdb ... hgdb hay ... zgdb cho chính mình.</p>
<p>Hết.</p>
<p>HVN at <a href="https://pymi.vn">https://pymi.vn</a> and <a href="https://www.familug.org">https://www.familug.org</a>.</p>
<p><a href="https://www.familug.org/p/ung-ho.html">Ủng hộ tác giả 🍺</a></p>


             
 
            
            
            







            <hr/>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2023-01-20T00:00:00+07:00">Fri 20 January 2023</time>
            <h4>Category</h4>
            <a class="category-link" href="./categories.html#frontpage-ref">frontpage</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="./tags.html#debugger-ref">debugger
                    <span class="superscript">1</span>
</a></li>
                <li><a href="./tags.html#gdb-ref">gdb
                    <span class="superscript">4</span>
</a></li>
                <li><a href="./tags.html#gef-ref">gef
                    <span class="superscript">1</span>
</a></li>
                <li><a href="./tags.html#peda-ref">peda
                    <span class="superscript">1</span>
</a></li>
                <li><a href="./tags.html#pwndbg-ref">pwndbg
                    <span class="superscript">2</span>
</a></li>
                <li><a href="./tags.html#python-ref">python
                    <span class="superscript">13</span>
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="./theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>